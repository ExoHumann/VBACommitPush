#!/usr/bin/env python3
"""Simple test runner for spotviso commands."""

import sys
import subprocess
import argparse


def run_smoke_tests():
    """Run smoke tests using pytest."""
    cmd = ["python", "-m", "pytest", "tests/", "-m", "smoke", "-v"]
    
    print("Running smoke tests...")
    print("Command:", " ".join(cmd))
    print()
    
    result = subprocess.run(cmd, capture_output=True, text=True)
    
    print(result.stdout)
    if result.stderr:
        print("STDERR:", result.stderr)
    
    return result.returncode == 0


def main():
    """Main entry point for spotviso test runner."""
    parser = argparse.ArgumentParser(description="VBACommitPush test runner")
    parser.add_argument("command", choices=["test"], help="Command to run")
    parser.add_argument("-m", "--marker", help="Test marker to run")
    
    args = parser.parse_args()
    
    if args.command == "test" and args.marker == "smoke":
        success = run_smoke_tests()
        sys.exit(0 if success else 1)
    else:
        print(f"Unknown command: {args.command}")
        sys.exit(1)


if __name__ == "__main__":
    main()